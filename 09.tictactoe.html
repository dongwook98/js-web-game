<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>í‹±íƒí† </title>
<style>
  h1 {
    text-align: center;
  }
  table {
    margin: 0 auto;
    width: 500px;
    height: 500px;
    border-collapse: collapse;
  }

  td {
    font-size: 3rem;
    border: 1px solid black;
    width: 166.333px;
    height: 166.333px;
    text-align: center;
  }

  div {
    margin-top: 20px;
    text-align: center;
    font-size: 4rem;
  }
</style>
</head>

<body>
  <h1>í‹±íƒí†  ê²Œì„</h1>
  <!-- <table>
    <tr>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </table> -->
<script>
  const { body } = document; // êµ¬ì¡°ë¶„í•´í• ë‹¹
  const $table = document.createElement('table');
  const $result = document.createElement('div');
  const rows = [];
  let turn = 'O';

  // [
  //   [$td, $td, $td],
  //   [$td, $td, $td],
  //   [$td, $td, $td],
  // ]

  const checkWinner = (target) => {
    const rowIndex = target.parentNode.rowIndex; // tríƒœê·¸ëŠ” rowIndexë¥¼ ìì²´ì ìœ¼ë¡œ ê°€ì§€ê³ ìˆìŒ
    const cellIndex = target.cellIndex; // tdíƒœê·¸ëŠ” cellIndexë¥¼ ìì²´ì ìœ¼ë¡œ ê°€ì§€ê³ ìˆìŒ
    
    
    let hasWinner = false; // ì„¸ì¹¸ ë‹¤ ì±„ì›Œì¡Œë‚˜?
    // ê°€ë¡œì¤„ ê²€ì‚¬
    if(
      rows[rowIndex][0].textContent === turn &&
      rows[rowIndex][1].textContent === turn &&
      rows[rowIndex][2].textContent === turn
    ) {
      hasWinner = true;
    }
    // ì„¸ë¡œì¤„ ê²€ì‚¬
    if (
      rows[0][cellIndex].textContent === turn &&
      rows[1][cellIndex].textContent === turn &&
      rows[2][cellIndex].textContent === turn
    ) {
      hasWinner = true;
    }
    // ëŒ€ê°ì„  ê²€ì‚¬
    if(
      rows[0][0].textContent === turn &&
      rows[1][1].textContent === turn &&
      rows[2][2].textContent === turn
    ) {
      hasWinner = true;
    }
    if ( 
      rows[0][2].textContent === turn &&
      rows[1][1].textContent === turn &&
      rows[2][0].textContent === turn 
    ) {
      hasWinner = true;
    }
    return hasWinner;
  }

  const callback = (event) => {
    if(event.target.textContent !== '') { // ì¹¸ì´ ì´ë¯¸ ì±„ì›Œì ¸ ìˆëŠ”ê°€?
      console.log('ë¹ˆì¹¸ì´ ì•„ë‹™ë‹ˆë‹¤.');
      return; // ì¹¸ì´ ì´ë¯¸ ìˆëŠ” ê²½ìš° ì•„ë˜ ì½”ë“œ ì‹¤í–‰ì•ˆë˜ê²Œ ë¦¬í„´!
    } 
    // ë¹ˆ ì¹¸ì´ë©´?
    console.log('ë¹ˆì¹¸ì…ë‹ˆë‹¤');
    event.target.textContent = turn;
    // ìŠ¹ë¶€ íŒë‹¨í•˜ê¸°
    const hasWinner = checkWinner(event.target);
    // ìŠ¹ìê°€ ìˆìœ¼ë©´
    if (hasWinner) {
      $result.textContent = `ğŸ‰ ${turn}ì˜ ìŠ¹ë¦¬! ğŸ‰`
      $table.removeEventListener('click', callback); // ìŠ¹ë¦¬ ì´í›„ì—ë„ í´ë¦­ì•ˆë˜ê²Œ ì´ë²¤íŠ¸ ì œê±°
      return;
    }
    // ìŠ¹ìê°€ ì—†ìœ¼ë©´
    // ë¬´ìŠ¹ë¶€ ê²€ì‚¬
    const draw = rows.flat().every((cell) => cell.textContent);
    if (draw) {
      $result.textContent =`ë¬´ìŠ¹ë¶€`;
      return;
    }
    turn = turn === 'X' ? 'O' : 'X';
  };
  
  for (let i = 0 ; i < 3; i++) {
    // createElementë¥¼ í•œë²ˆ ë§Œë“¤ë©´ í•œë²ˆë°–ì— ëª»ì”€ (ì£¼ì˜)
    const $tr = document.createElement('tr');
    const cells = []; // ë°ì´í„° 3ê°œ ë§Œë“¤ì–´ì¤Œ ë°˜ë³µë¬¸ ëŒ ë•Œ ë§ˆë‹¤ ìƒˆë¡œìš´ ë°°ì—´ì´ ìƒì„±ë˜ëŠ” ê±°ì„ (ì¤‘ìš”)
    for (let j = 0; j < 3; j++) {
      const $td = document.createElement('td');
      cells.push($td);
      $tr.append($td);
    }
    rows.push(cells);
    $table.append($tr);
  }

  $table.addEventListener('click', callback); // ì´ë²¤íŠ¸ ë²„ë¸”ë§ ì´ìš©!
  body.append($table);
  body.append($result);
</script>
</body>